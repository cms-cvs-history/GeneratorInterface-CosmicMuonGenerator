process TEST  = {

    untracked PSet configurationMetadata = {
           untracked string version = "$Revision: 1.2 $"
           untracked string name = "$Source: /local/projects/CMSSW/rep/CMSSW/IOMC/CosmicMuonGenerator/test/CosmicMuonsUndergroundTrackerSim.cfg,v $"
           untracked string annotation = "cosmic"
    }

    # initialize  MessageLogger
    include "FWCore/MessageLogger/data/MessageLogger.cfi"
    
    service = RandomNumberGeneratorService {
	untracked uint32 sourceSeed = 9876543
	PSet moduleSeeds = {
	    untracked uint32 g4SimHits = 1234567
	}
    }

    # Monitor
    untracked PSet options = {
	untracked bool wantSummary = true
    }

    untracked PSet maxEvents = { 
	#untracked int32 input = 1000 # first test with generator cut...
	untracked PSet output = {
	    untracked int32 FEVTSIM = 100 # ...output cut only may take long!
	}
    }
    #
    # Step 1 : Event Generation
    #
    source = CosMuoGenSource {
	untracked double MinEn = 10.
	untracked double MinEn_CMS = 7.
	untracked double MaxEn =   10000.
	untracked double MinTheta =  0.
	untracked double MaxTheta = 65. # in grad
	untracked double MinPhi =    0.
	untracked double MaxPhi =  360.
	untracked double MinT0  =  -12.5
	untracked double MaxT0  =   12.5
	untracked double ElossScaleFactor = 1.0
	untracked bool TrackerOnly = false # true: detector with tracker-only setup is used,
	#                                    so no material or B-field outside is considerd
	untracked bool MTCCHalf = false
	# target volume: straight line extrapolation from CMS surface has to hit this volume
	untracked double RadiusOfTarget = 8000. # default  8000.
	untracked double ZDistOfTarget = 15000. # default 15000.
    }

    #
    # Setp 2: Filtering before GEANT4
    #
    include "GeneratorInterface/GenFilters/data/CosmicGenFilterHelix.cfi" # defines cosmicInTracker

    #
    # Step 3: Filtering after SimHits produced.
    #
# FIXME: module not available in nightly 2007-05-14... 
#    module hitsInTk = TrackerMuFilter {
#	untracked bool TrackerHits=true
#	untracked bool DTMuonHits=false
#	untracked bool CSCMuonHits=false
#	untracked bool RPCMuonHits=false
#    }
    
    #
    # Step 4: Simulation (with vertex smearing disabled)
    #
    include "Configuration/StandardSequences/data/Simulation.cff"
    include "Configuration/StandardSequences/data/MixingNoPileUp.cff" 
    
    #
    # Step 5: Event output
    #
    include "Configuration/EventContent/data/EventContent.cff"
    module FEVTSIM = PoolOutputModule { 
	using FEVTSIMEventContent
	untracked string fileName = "file:cosmics_sim.root"
        untracked PSet datasets = {
         untracked PSet dataset1 = {
            untracked string dataTier = "GEN-SIM" 
         }
        }
    }
    
    #
    # Order of execution: Apart from GEANT restrict to tracker.
    #
    endpath p  = {cosmicInTracker, g4SimHits, #hitsInTk, 
	FEVTSIM}
}
